/*-------------------------------------------------------------------------------------------------
 Date Edited   Developer    Description
---------------------------------------------------------------------------------------------------
 06 October 2016   Roxanne Rassool   Created
---------------------------------------------------------------------------------------------------

 Created By  	: RRZ Innovations (PTY) LTD
 Date Created 	: 06 October 2016
 Title   		: 15_schema_2016.06.1.1
 Purpose  		: Add more rights into the tables 
 Instructions 	: Run after 14_schema_2016.10.1.1.sql

-------------------------------------------------------------------------------------------------*/

UPDATE SysInfo
SET SettingValue='15'
WHERE SettingName = 'DBVersion'
GO

INSERT INTO Application_Rights (ID, RightGroup, Name, FriendlyName, Description)
VALUES
('E3D305F4-338D-478A-959D-6AC7F7901544','Packages','GetMyCart','View Company Cart','View the package and features in the cart'),
('1ACB02DD-1420-4A3B-B720-1A544F6E7835','Packages','GetMyPackage','View Company Package','View the details and features for the package that the company is on')
GO



INSERT INTO ApplicationRightsInRoles(ID, RoleID, ApplicationRightID, DateAssigned, UserAssigned, DateUpdated, LastUserUpdated)
VALUES
(newid(),'8FF17FF3-56D6-4D5B-A8D0-9DC0D473CDDC','E3D305F4-338D-478A-959D-6AC7F7901544','10/06/2016','82359D8E-2FB6-4B92-A39B-3B54BBD3DD25','10/06/2016','82359D8E-2FB6-4B92-A39B-3B54BBD3DD25'),
(newid(),'8FF17FF3-56D6-4D5B-A8D0-9DC0D473CDDC','1ACB02DD-1420-4A3B-B720-1A544F6E7835','10/06/2016','82359D8E-2FB6-4B92-A39B-3B54BBD3DD25','10/06/2016','82359D8E-2FB6-4B92-A39B-3B54BBD3DD25')
GO


--select newid()

CREATE TABLE Invoice
(
	ID UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
	InvoiceNumber BIGINT NOT NULL IDENTITY,
	InvoiceDate DATETIME NOT NULL,
	CompanyID UNIQUEIDENTIFIER NOT NULL,
	CompanyName VARCHAR(256) NOT NULL,
	RegistrationNumber VARCHAR(256) NULL,
	VatNumber VARCHAR(128) NULL,
	PhysicalAddress VARCHAR(MAX) NULL,
	PackageID UNIQUEIDENTIFIER NOT NULL,
	CompanyPackageID UNIQUEIDENTIFIER NOT NULL
)
GO

CREATE TABLE InvoiceLineItem
(
	ID UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
	InvoiceID UNIQUEIDENTIFIER NOT NULL,
	LineItem VARCHAR(MAX) NOT NULL,
	Quantity BIGINT NOT NULL,
	Price DECIMAL(18,2) NOT NULL
)
GO

insert into packageFeatures (ID, PackageID, FeatureID, OptionalFeature)
VALUES 
--free mandatory
(newID(), '1D2F5C8A-C310-4C4C-9D44-1A9B93E547F3', '7C0B74B6-A09B-4418-96A0-E7E0EDD45EAC',0),
--pro mandatory
(newID(), 'D9CF32CE-C646-47A0-BD7F-6F06D0CE6690', '7C0B74B6-A09B-4418-96A0-E7E0EDD45EAC',0),
--enterprise mandatory
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '407A4650-CC86-4B0E-BD80-1CE7232557B6',0),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '49FE9FF2-83FE-4474-968E-2329EB66BFF3',0),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '4D47F7D7-2BDD-4D50-8C3E-693A21AFC3AD',0),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '6B28A3B7-7618-4146-8DAC-CD12C9ED9053',0),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', 'BC91DB3B-C5D1-4274-90B4-EE04432C1A3E',0),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '85A98396-EF36-481C-9020-F2F9C6E9E9A9',0)
GO

insert into packageFeatures (ID, PackageID, FeatureID, OptionalFeature, OptionalPrice)
VALUES
--free optional
(newID(), '1D2F5C8A-C310-4C4C-9D44-1A9B93E547F3', 'A53BCF1A-40A8-451F-A97F-637ED1B6D418',1,4),
--pro optional
(newID(), 'D9CF32CE-C646-47A0-BD7F-6F06D0CE6690', 'A53BCF1A-40A8-451F-A97F-637ED1B6D418',1,3),
(newID(), 'D9CF32CE-C646-47A0-BD7F-6F06D0CE6690', '6B28A3B7-7618-4146-8DAC-CD12C9ED9053',1,3),
--enterprise optional
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', 'A76BC29B-CFDE-4AE5-80BD-59C7BC888467',1,2),
(newID(), '9758FF8B-AAEF-4D88-88AA-8B5EDADF7F0E', '433D2ADA-FA92-40FE-B0F9-D16B3A1CA5AA',1,2),
--custom optional
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '407A4650-CC86-4B0E-BD80-1CE7232557B6',1,3),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '49FE9FF2-83FE-4474-968E-2329EB66BFF3',1,1),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', 'A76BC29B-CFDE-4AE5-80BD-59C7BC888467',1,2),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', 'A53BCF1A-40A8-451F-A97F-637ED1B6D418',1,3),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '4D47F7D7-2BDD-4D50-8C3E-693A21AFC3AD',1,2),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', 'DA97707E-899A-4AD8-B159-B476ED9866DD',1,5),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '6B28A3B7-7618-4146-8DAC-CD12C9ED9053',1,4),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '433D2ADA-FA92-40FE-B0F9-D16B3A1CA5AA',1,2),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', 'BC91DB3B-C5D1-4274-90B4-EE04432C1A3E',1,2),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '7492F4A1-4F41-40E4-A55E-F038FE7F6A7A',1,5),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '85A98396-EF36-481C-9020-F2F9C6E9E9A9',1,3),
(newID(), '6AC61C3B-E4CC-4188-98F4-F1BE9B8CB7CA', '7C0B74B6-A09B-4418-96A0-E7E0EDD45EAC',1,1)
GO